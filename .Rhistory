filter(Comuna%in%c("Valparaíso","Viña del Mar","Concón",
"Casablanca","Limache","Quilpué","Villa Alemana"))
surroundings %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
comunas
surroundings %>%
st_mask(valpo) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))+
coord_sf(xlim = disp_win_coord[,'X'], ylim = disp_win_coord[,'Y'],expand = FALSE)
surroundings %>%
valpo %>%
st_buffer(1000) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))+
coord_sf(xlim = disp_win_coord[,'X'], ylim = disp_win_coord[,'Y'],expand = FALSE)
valpo %>%
st_buffer(1000) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))+
coord_sf(xlim = disp_win_coord[,'X'], ylim = disp_win_coord[,'Y'],expand = FALSE)
valpo %>%
st_buffer(1000) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
valpo %>%
st_buffer(10000) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
valpo %>%
st_buffer(10000) %>%
st_boundary() %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
valpo %>%
st_buffer(20000) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
valpo %>%
st_buffer(20000) %>%
st_convex_hull() %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
valpo %>%
st_buffer(20000) %>%
st_bbox() %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
valpo %>%
st_buffer(20000) %>%
st_bbox()
st_bbox(surroundings)
st_contains(valpo,surroundings)
st_bbox(surroundings)
st_bbox(surroundings) <- st_bbox(valpo)
surroundings %>%
st_crop(st_bbox(valpo)) %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
surroundings <- comunas %>%
filter(Comuna%in%c("Valparaíso","Viña del Mar","Concón",
"Casablanca","Limache","Quilpué","Villa Alemana")) %>%
st_crop(st_bbox(valpo))
surroundings %>%
ggplot()+geom_sf()+geom_sf_text(aes(label=Comuna))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
lakes_in_valpo <- st_join(aguas_transformed,valpo,left=FALSE)
lakes_in_valpo$Nombre
lakes_in_valpo$include <- c(0,0,0,0,0,0,1,1,0,0,0,1,1,0,1,1,0)
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-3500,-4000,0,3000,0,-1000)
nudge_y_vals <- c(-1500,-500,1000,-1000,-1000,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-2500,-4000,0,3000,0,-1000)
nudge_y_vals <- c(-1500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,col=Tipo),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
nudge_x_vals <- c(-2500,-4000,0,3000,0,-1000)
nudge_y_vals <- c(-1500,-500,1000,-1000,-1000,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,col=Tipo),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
subset(lakes_in_valpo,include==1)$Nombre
nudge_y_vals <- c(-1500,-500,1000,-1000,-1000,1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,col=Tipo),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
subset(lakes_in_valpo,include==1)$Nombre
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
nudge_x_vals <- c(-1500,-4000,0,3000,0,-1000)
nudge_y_vals <- c(-1500,-500,1000,-1000,-1000,1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
subset(lakes_in_valpo,include==1)$Nombre
nudge_y_vals <- c(-1500,-500,1000,-1000,-500,-1000)
textcol <- "midnightblue"
nudge_x_vals <- c(-2000,-4000,0,3000,0,-1000)
nudge_y_vals <- c(-1500,-500,1000,-1000,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
View(lakes_in_valpo)
lakes_in_valpo$Nombre
lakes_in_valpo$include <- c(0,0,1,0,0,0,1,1,0,0,0,1,1,0,1,1,0)
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-4000,-2000,-4000,0,3000,0,-1000)
nudge_y_vals <- c(0,-1500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
lakes_in_valpo$include <- c(0,0,1,0,0,0,1,1,0,0,0,1,1,0,1,1,0)
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-4000,-2000,-4000,0,3000,0,-1000)
nudge_y_vals <- c(0,-1500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
nudge_x_vals <- c(-2000,-2000,-4000,0,3000,0,-1000)
nudge_y_vals <- c(-500,-1500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=11, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=10)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=2)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-2000,-2000,-4000,2000,3000,0,-1000)
nudge_x_vals <- c(-1000,-2000,-4000,2000,3000,0,-1000)
nudge_y_vals <- c(-1000,-1500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
nudge_x_vals <- c(0,-2000,-4000,2000,3000,0,-1000)
nudge_y_vals <- c(-3000,-1500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
nudge_x_vals <- c(-2000,0,-4000,2000,3000,0,-1000)
nudge_y_vals <- c(-500,-3000,-500,1000,-800,-500,-1000)
nudge_x_vals <- c(-2000,-1000,-4000,2000,3000,0,-1000)
nudge_y_vals <- c(-500,-3000,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
lakes_in_valpo <- st_join(aguas_transformed,valpo,left=FALSE) %>%
mutate(Nombre=ifelse(Nombre=="Estero Vina del Mar","Estero Viña del Mar",Nombre))
lakes_in_valpo$Nombre
lakes_in_valpo$include <- c(0,0,1,0,0,0,1,1,0,0,0,1,1,0,1,1,0)
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-2000,-500,-4000,2000,3000,0,-1000)
nudge_y_vals <- c(-500,-2500,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,col=Tipo),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,col=Tipo),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey80")+
geom_sf(data=valpo,fill="grey50")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey90")+
geom_sf(data=valpo,fill="grey70")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 13, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=surroundings,fill="grey90")+
geom_sf(data=valpo,fill="grey70")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 15, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
subset(lakes_in_valpo,include==1)$Nombre
nudge_x_vals <- c(-2000,-500,-4000,2300,3000,0,-1000)
nudge_y_vals <- c(-700,-2800,-500,1000,-800,-500,-1000)
textcol <- "midnightblue"
ggplot() +
geom_sf(data=surroundings,fill="grey90")+
geom_sf(data=valpo,fill="grey70")+
geom_sf(data=lakes_in_valpo,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_valpo,include==1),
aes(label=Nombre,),nudge_x=nudge_x_vals,nudge_y=nudge_y_vals,
family="sans",col=textcol,size=4)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 15, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
View(comunas)
loslagos <- comunas %>%
filter(Region == "Región de Los Lagos")
lakes_in_loslagos <- st_join(aguas_transformed,loslagos,left=FALSE)
View(lakes_in_loslagos)
lakes_in_loslagos$include <- lakes_in_loslagos$st_area_sh.x>3000000
subset(lakes_in_valpo,include==1)$Nombre
subset(lakes_in_loslagos,include)$Nombre
textcol <- "midnightblue"
ggplot() +
geom_sf(data=loslagos,fill="grey70")+
geom_sf(data=lakes_in_loslagos,aes(fill=Tipo,col=Tipo))+
geom_sf_text(data=subset(lakes_in_loslagos,include),
aes(label=Nombre,),
family="sans",col=textcol,size=3)+
labs(title="Masas de agua en Valparaíso y Viña del Mar, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 15, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=loslagos,fill="grey70")+
geom_sf(data=lakes_in_loslagos,aes(fill=Tipo,col=Tipo))+
ggrepel::geom_text_repel(
data = subset(lakes_in_loslagos,include),
aes(label = Nombre, geometry = geometry),
stat = "sf_coordinates",
min.segment.length = 0
)
ggplot() +
geom_sf(data=loslagos,fill="grey70")+
geom_sf(data=lakes_in_loslagos,aes(fill=Tipo,col=Tipo))+
ggrepel::geom_text_repel(
data = subset(lakes_in_loslagos,include),
aes(label = Nombre, geometry = geometry),
stat = "sf_coordinates",
min.segment.length = 0,
family="sans",col=textcol,size=3
)+
labs(title="Masas de agua en la región de Los Lagos, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 15, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
ggplot() +
geom_sf(data=loslagos,fill="grey70")+
geom_sf(data=lakes_in_loslagos,fill=textcol)+
ggrepel::geom_text_repel(
data = subset(lakes_in_loslagos,include),
aes(label = Nombre, geometry = geometry),
stat = "sf_coordinates",
min.segment.length = 0,
family="sans",col=textcol,size=3
)+
labs(title="Masas de agua en la región de Los Lagos, Chile",x="",y="",
caption="Data: Biblioteca del Congreso Nacional de Chile")+
theme_light()+
theme(plot.background = element_rect(fill = "aliceblue"),
panel.background = element_rect(fill="aliceblue"),
plot.title = element_text(family = "sans", face = "bold", size = 15, colour = textcol),
plot.caption = element_text(family = "sans" ,size=10, colour = textcol))
